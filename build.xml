<?xml version="1.0"?>

<!--
  =============================================================================
    Master build file for building all Cactus components (the Ant tasks,
    the framework itself, the Integrations, the documentation, the samples, 
    etc).

    See build.properties.sample for details of mandatory and optional
    properties to set.

    This script should be started with the following command line :

        ant <target>

    Run "ant -projecthelp" to get a list of available targets.
  =============================================================================
-->
<project name="Master Cactus Build" default="release" basedir=".">

    <!-- Give user a chance to override without editing this file
         (and without typing -D each time it compiles it) -->
    <property file="${basedir}/build.properties" />
    <property file="${user.home}/build.properties" />

    <!--
       ========================================================================
         Generate the release files for all the Cactus subprojects
       ========================================================================
    -->
    <target name="release" depends="clean">

        <ant antfile="anttasks/build.xml" inheritAll="false" 
            target="release"/>

        <ant antfile="framework/build.xml" inheritAll="false" 
            target="release">
            <property name="j2ee.jar" value="${j2ee.12.jar}"/> 
            <property name="clover.enable" value="true"/> 
        </ant>

        <ant antfile="framework/build.xml" inheritAll="false" 
            target="release">
            <property name="j2ee.jar" value="${j2ee.13.jar}"/> 
            <property name="clover.enable" value="true"/> 
        </ant>

        <ant antfile="integration/ant/build.xml" inheritAll="false" 
            target="release">
            <property name="j2ee.jar" value="${j2ee.12.jar}"/> 
            <property name="clover.enable" value="true"/> 
        </ant>

        <ant antfile="integration/ant/build.xml" inheritAll="false" 
            target="release">
            <property name="j2ee.jar" value="${j2ee.13.jar}"/> 
            <property name="clover.enable" value="true"/> 
        </ant>

        <ant antfile="integration/eclipse/org.apache.cactus.eclipse.webapp/build.xml" 
            inheritAll="false" target="release">
        </ant>
            
        <ant antfile="integration/eclipse/org.apache.cactus.eclipse.runner/build.xml" 
            inheritAll="false" target="release">
            <property name="j2ee.jar" value="${j2ee.12.jar}"/> 
        </ant>

        <ant antfile="integration/eclipse/org.apache.cactus.eclipse.runner/build.xml" 
            inheritAll="false" target="release">
            <property name="j2ee.jar" value="${j2ee.13.jar}"/> 
        </ant>

        <ant antfile="samples/servlet/build.xml" inheritAll="false" 
            target="release">
            <property name="j2ee.jar" value="${j2ee.12.jar}"/> 
            <property name="clover.enable" value="true"/> 
        </ant>

        <ant antfile="samples/servlet/build.xml" inheritAll="false" 
            target="release">
            <property name="j2ee.jar" value="${j2ee.13.jar}"/> 
            <property name="clover.enable" value="true"/> 
        </ant>
        
        <!-- ant antfile="samples/jetty/build.xml" inheritAll="false" 
            target="release">
            <property name="j2ee.jar" value="${j2ee.13.jar}"/> 
            <property name="clover.enable" value="true"/> 
        </ant -->
        
        <ant antfile="documentation/build.xml" inheritAll="false" 
            target="release">
            <property name="javadoc.include" value="true"/>
            <property name="clover.enable" value="true"/> 
        </ant>

    </target>

    <!--
       ========================================================================
         Clean all generated files by all Cactus subprojects.
       ========================================================================
    -->
    <target name="clean">

        <delete dir="target-12"/>
        <delete dir="target-13"/>
        <delete>
            <fileset dir="." includes="**/*.log"/>
        </delete>
 
        <ant antfile="anttasks/build.xml" inheritAll="false" 
            target="clean"/>

        <ant antfile="framework/build.xml" inheritAll="false" 
            target="clean">
            <property name="j2ee.jar" value="${j2ee.12.jar}"/> 
        </ant>

        <ant antfile="framework/build.xml" inheritAll="false" 
            target="clean">
            <property name="j2ee.jar" value="${j2ee.13.jar}"/> 
        </ant>

        <ant antfile="integration/ant/build.xml" inheritAll="false" 
            target="clean">
            <property name="j2ee.jar" value="${j2ee.12.jar}"/> 
        </ant>

        <ant antfile="integration/ant/build.xml" inheritAll="false" 
            target="clean">
            <property name="j2ee.jar" value="${j2ee.13.jar}"/> 
        </ant>

        <ant antfile="integration/eclipse/org.apache.cactus.eclipse.webapp/build.xml" 
            inheritAll="false" target="clean">
        </ant>
                
        <ant antfile="integration/eclipse/org.apache.cactus.eclipse.runner/build.xml" 
            inheritAll="false" target="clean">
            <property name="j2ee.jar" value="${j2ee.12.jar}"/> 
        </ant>

        <ant antfile="integration/eclipse/org.apache.cactus.eclipse.runner/build.xml" 
            inheritAll="false" target="clean">
            <property name="j2ee.jar" value="${j2ee.13.jar}"/> 
        </ant>
        
        <ant antfile="samples/servlet/build.xml" inheritAll="false" 
            target="clean">
            <property name="j2ee.jar" value="${j2ee.12.jar}"/> 
        </ant>

        <ant antfile="samples/servlet/build.xml" inheritAll="false" 
            target="clean">
            <property name="j2ee.jar" value="${j2ee.13.jar}"/> 
        </ant>
        
        <ant antfile="samples/jetty/build.xml" inheritAll="false" 
            target="clean">
            <property name="j2ee.jar" value="${j2ee.13.jar}"/> 
        </ant>
        
        <ant antfile="documentation/build.xml" inheritAll="false" 
            target="clean"/>

    </target>

</project>