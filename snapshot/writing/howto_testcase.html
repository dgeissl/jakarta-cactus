<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">











<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Jakarta Cactus - Writing Cactus TestCase</title>
    <style type="text/css" media="all">
      @import url("../css/maven-base.css");
      @import url("../css/maven-theme.css");
      @import url("../css/site.css");
    </style>
    <link rel="stylesheet" href="../css/print.css" type="text/css" media="print" />
          </head>
  <body class="composite">
    <div id="banner">
                  <a href="http://jakarta.apache.org/cactus/" id="bannerLeft">
    
                                            <img src="../images/logocactus.gif" alt="" />
    
            </a>
                        <a href="http://jakarta.apache.org/" id="bannerRight">
    
                                            <img src="../images/jakarta-logo.gif" alt="" />
    
            </a>
            <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
          
  

  
    
  
  
    
            <div class="xleft">
        Last Published: 2016-11-27
                          |   
                <a href="http://www.apache.org/" class="externalLink">Apache</a>
                &gt;
      
                <a href="http://www.jakarta.apache.org/" class="externalLink">Jakarta</a>
                &gt;
      
                <a href="http://jakarta.apache.org/cactus/" class="externalLink">Cactus</a>
                          </div>
            <div class="xright">      
  

  
    
  
  
    
  </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
           
  

  
    
  
  
    
                   <h5>About</h5>
            <ul>
              
    <li class="none">
                    <a href="../index.html">Overview</a>
          </li>
              
    <li class="none">
                    <a href="../goals.html">Goals</a>
          </li>
              
    <li class="none">
                    <a href="../features.html">Features</a>
          </li>
              
    <li class="none">
                    <a href="../news.html">News</a>
          </li>
              
    <li class="none">
                    <a href="../downloads.html">Downloads</a>
          </li>
              
    <li class="none">
                    <a href="http://issues.apache.org/jira/secure/BrowseProject.jspa?id=10471" class="externalLink">Bug Database</a>
          </li>
              
    <li class="none">
                    <a href="../mail-lists.html">Mailing Lists</a>
          </li>
              
    <li class="none">
                    <a href="../faq.html">FAQ</a>
          </li>
              
    <li class="none">
                    <a href="http://wiki.apache.org/jakarta-cactus/FrontPage" class="externalLink">Wiki</a>
          </li>
              
    <li class="none">
                    <a href="../license.html">License</a>
          </li>
          </ul>
              <h5>Documentation</h5>
            <ul>
              
    <li class="none">
                    <a href="../getting_started.html">Getting started</a>
          </li>
              
    <li class="none">
                    <a href="../how_it_works.html">How it works</a>
          </li>
              
                
              
      
            
      
            
      
            
      
            
      
            
      
            
            
            
      
            
      
            
      
              
            <li class="expanded">
                    <a href="../writing/howto_ejb.html">Writing tests</a>
                  <ul>
                  
    <li class="none">
                    <a href="../writing/howto_ejb_j2eeri.html">Howto EJB</a>
          </li>
                  
    <li class="none">
                    <a href="../writing/howto_ejb_3.html">Howto EJB3</a>
          </li>
                  
    <li class="none">
                    <a href="../writing/howto_httpunit.html">Howto HTTPUnit</a>
          </li>
                  
    <li class="none">
                    <a href="../writing/howto_htmlunit.html">Howto HTMLUnit</a>
          </li>
                  
    <li class="none">
                    <a href="../writing/howto_jsp.html">Howto JSP</a>
          </li>
                  
    <li class="none">
                    <a href="../writing/howto_security.html">Howto Security</a>
          </li>
                  
    <li class="none">
              <strong>Howto TestCase</strong>
        </li>
                  
    <li class="none">
                    <a href="../writing/howto_testcase_jsp.html">Howto TestCase-JSP</a>
          </li>
                  
    <li class="none">
                    <a href="../writing/howto_testcase_filter.html">Howto TestCase-Filter</a>
          </li>
                  
    <li class="none">
                    <a href="../writing/howto_testcase_servlet.html">Howto TestCase-Servlet</a>
          </li>
              </ul>
        </li>
              
                
              
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
                  
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
                  
      
            
      
            
      
                  
      
            
      
            
      
              
        <li class="collapsed">
                    <a href="../integration/index.html">Running tests</a>
                </li>
              
                
              
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
              
        <li class="collapsed">
                    <a href="../participating/index.html">Participating</a>
                </li>
          </ul>
              <h5>Miscellaneous</h5>
            <ul>
              
    <li class="none">
                    <a href="../cactusname.html">Why the name</a>
          </li>
              
    <li class="none">
                    <a href="../mock_vs_cactus.html">Mock vs Container</a>
          </li>
              
    <li class="none">
                    <a href="http://wiki.apache.org/jakarta-cactus/TestedOn" class="externalLink">Tested On...</a>
          </li>
              
                
              
      
            
      
            
      
            
      
            
      
              
        <li class="collapsed">
                    <a href="../resources/index.html">Resources</a>
                </li>
          </ul>
              <h5>Translations</h5>
            <ul>
              
    <li class="none">
                    <a href="http://www.ressources-java.net/cactus" class="externalLink">French</a>
          </li>
              
    <li class="none">
                    <a href="http://jakarta.apache-korea.org/cactus/index.html" class="externalLink">Korean</a>
          </li>
              
    <li class="none">
                    <a href="http://www.jajakarta.org/cactus/" class="externalLink">Japanese</a>
          </li>
          </ul>
              <h5>See also</h5>
            <ul>
              
    <li class="none">
                    <a href="http://www.apachebookstore.com/" class="externalLink">Apache Bookstore</a>
          </li>
              
    <li class="none">
                    <a href="http://www.planetapache.org/" class="externalLink">Planet Apache</a>
          </li>
              
    <li class="none">
                    <a href="http://apache.org/foundation/thanks.html" class="externalLink">Apache Sponsors</a>
          </li>
          </ul>
                                                 
                        
                        
            <a href="http://jakarta.apache.org/cactus/" title="Jakarta Cactus" class="poweredBy">
                            <img alt="Jakarta Cactus" src="../images/cactusbanner.gif" />
            </a>
                               
  

  
    
  
  
    
        </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
        <div class="section"><h2><a name="Introduction"></a>Introduction</h2>
<p>
                This tutorial explains how to write a test case, using Cactus. There
                are several types of test cases: test cases for writing servlet
                unit tests, test cases for writing taglib unit tests and test cases
                for writing filter unit tests. We will first cover the principles
                which are generic to all test cases and then we will dive into
                the details specific to each test case.
            </p>
<ul><li><a href="howto_testcase.html#general_principles">General principles</a></li>
<li><a href="howto_testcase.html#specific_details">TestCase specific details</a></li>
</ul>
<note>
                In order to help writing test case we highly suggest to have a look
                at the examples provided as part of the Cactus distribution. Also,
                all the best practices for JUnit also applies to Cactus test cases
                as they are in essence JUnit test cases.
            </note></div>
<anchor id="general_principles"><div class="section"><h2><a name="General_principles"></a>General principles</h2>
<p>
                To write a test case, please follow the steps defined below.
            </p>
<div class="section"><h2><a name="Step_1:_Imports"></a>Step 1: Imports</h2>
<p>
                    You need to include the following imports in your test class (
                    <code>junit.framework.*</code>
                    is needed because Cactus uses JUnit
                    as the client side application for calling the tests):
                </p>
<div class="source"><pre>
import org.apache.cactus.*;
import junit.framework.*;
</pre>
</div>
</div>
<div class="section"><h2><a name="Step_2:_Extend_a_Cactus_TestCase_class_or_reuse_a_JUnit_TestCase"></a>Step 2: Extend a Cactus TestCase class or reuse a JUnit TestCase</h2>
<div class="section"><h2><a name="Option_A:_Extend_a_Cactus_TestCase_class"></a>Option A: Extend a Cactus TestCase class</h2>
<p>
                        We need to create a class (our test class) that extends one of
                        Cactus test cases, depending on what we are testing:
                    </p>
<ul><li><strong><code>ServletTestCase</code></strong>
                            : extend this class
                            for writing tests for unit testing code that uses Servlet API
                            objects (<code>HttpServletRequest</code>,
                            <code>HttpServletResponse</code>, <code>HttpSession</code>,
                            <code>ServletConfig</code>, <code>ServletContext</code>, ...),
                            like Servlets or any java classes which have methods that
                            manipulates Servlet API objects. For example:
                            <br />
<br />
<div class="source"><pre>
public class TestSampleServlet extends ServletTestCase
{
</pre>
</div>
<br />
</li>
<li><strong><code>JspTestCase</code></strong>
                            : extend this class for
                            writing tests for unit testing code that uses JSP API objects
                            (<code>PageContext</code>, <code>JspWriter</code>, ...), like
                            Taglibs or any java classes which have methods that manipulates
                            JSP API objects. For example:
                            <br />
<br />
<div class="source"><pre>
public class TestSampleTag extends JspTestCase
{
</pre>
</div>
<br />
</li>
<li><strong><code>FilterTestCase</code></strong>
                            : extend this class
                            for writing tests for unit testing code that uses Filter API
                            objects (<code>FilterChain</code>, <code>FilterConfig</code>,
                            <code>HttpServletRequest</code>, <code>HttpServletResponse</code>,
                            ...), like Filters or any java classes which have methods that
                            manipulates Filter API objects. For example:
                            <br />
<br />
<div class="source"><pre>
public class TestSampleFilter extends FilterTestCase
{
</pre>
</div>
<br />
</li>
</ul>
</div>
<div class="section"><h2><a name="Option_B:_reuse_a_JUnit_TestCase"></a>Option B: reuse a JUnit TestCase</h2>
<p>
                        Cactus is able to run pure JUnit TestCase on the server side.
                        This is done by using the <code>ServletTestSuite</code> Test Suite
                        that wraps your existing Test Cases. For example:
                        <br />
<br />
<div class="source"><pre>
public class TestJUnitTestCaseWrapper extends TestCase
{
    public static Test suite()
    {
        ServletTestSuite suite = new ServletTestSuite();
        suite.addTestSuite(TestJUnitTestCaseWrapper.class);
        return suite;
    }

    public void testXXX()
    {
    }
}
</pre>
</div>
</p>
</div>
</div>
<div class="section"><h2><a name="Step_3_optional:_setUp_and_tearDown_methods"></a>Step 3 (optional): setUp() and tearDown() methods</h2>
<p>
                    As in JUnit, you can define a <code>setUp()</code> and a
                    <code>tearDown()</code>
                    methods. They are executed respectively
                    before and after each test case. However, whereas in JUnit they are
                    executed on the client side, in Cactus they are executed on the
                    server side. It means that you will be able to access the Cactus
                    implicit object (these are the objects from the API as described
                    in Step 2) within them. In other words, you'll be able to do
                    things such as putting a value in the HTTP Session prior to calling
                    the test cases, etc.
                </p>
<p>
                    As in JUnit, the <code>setUp()</code> and
                    <code>tearDown()</code>
                    methods are optional.
                </p>
</div>
<div class="section"><h2><a name="Step_4_optional:_begin_and_end_methods"></a>Step 4 (optional): begin() and end() methods</h2>
<p><code>begin(...)</code>
                    and <code>end(...)</code> methods are the
                    client side equivalent of the <code>setUp()</code> and a
                    <code>tearDown()</code>
                    methods (see previous step). They are called
                    on the client side, before and after every test.
                </p>
<p>
                    The <code>begin()</code> and
                    <code>end()</code>
                    methods are optional.
                </p>
</div>
<div class="section"><h2><a name="Step_5:_testXXX_methods"></a>Step 5: testXXX() methods</h2>
<p>
                    As in JUnit, the main method for a test is the
                    <code>testXXX()</code>
                    method. The difference being that these
                    methods are executed in the container with Cactus. Each XXX test
                    case must have a <code>testXXX()</code> method defined.
                </p>
<p>
                    In your <code>testXXX()</code> methods you will:
                </p>
<ul><li>
                        instantiate the class to test (you can also factor this instance
                        out and define is as a class instance variable),
                    </li>
<li>
                        setup any server-side domain object (like putting a variable in
                        the Http session, ...). Indeed, the Cactus test case class that
                        you have extended in Step 2 has several instance variables (they
                        are the different API objects mentioned in Step 2) that it has
                        initialised with valid objects. Depending on the test case class
                        that you have extended these variables are
                        <code>request</code>
                        (of type <code>HttpServletRequest</code>),
                        <code>config</code>
                        (of type <code>ServletConfig</code> for
                        <code>ServletTestCase</code>
                        or of type
                        <code>FilterConfig</code>
                        for <code>FilterTestCase</code>), ... (see the &quot;Testcase Specific
                        Details&quot; Step below),
                    </li>
<li>
                        call the method to test,
                    </li>
<li>
                        perform JUnit standard asserts (<code>asserts(..)</code>,
                        <code>assertEquals(...)</code>, <code>fail(...)</code>, ...) to
                        verify that the test was successful
                    </li>
</ul>
<p>
                    For example:
                </p>
<div class="source"><pre>
public void testXXX()
{
    // Initialize class to test
    SampleServlet servlet = new SampleServlet();

    // Set a variable in session as the doSomething() method that we are testing need
    // this variable to be present in the session (for example)
    session.setAttribute(&quot;name&quot;, &quot;value&quot;);

    // Call the method to test, passing an HttpServletRequest object (for example)
    String result = servlet.doSomething(request);

    // Perform verification that test was successful
    assertEquals(&quot;something&quot;, result);
    assertEquals(&quot;otherValue&quot;, session.getAttribute(&quot;otherName&quot;));
}
</pre>
</div>
</div>
<div class="section"><h2><a name="Step_6_optional:_beginXXX_methods"></a>Step 6 (optional): beginXXX() methods</h2>
<p>
                    For each XXX test case, you can define a corresponding
                    <code>beginXXX()</code>
                    method (optional). You will use it to
                    initialize HTTP related parameters (HTTP parameters, cookies,
                    HTTP headers, URL to simulate, ...). You will be able to retrieve
                    these values in your <code>testXXX()</code> by calling the different
                    API of <code>HttpServletRequest</code> (like
                    <code>getQueryString()</code>, <code>getCookies()</code>,
                    <code>getHeader()</code>, ...).
                </p>
<p>
                    The signature of the begin method is:
                </p>
<div class="source"><pre>
public void beginXXX(WebRequest theRequest)
{
  [...]
}
</pre>
</div>
<p>
                    where <code>theRequest</code> is the object (provided by Cactus)
                    that you use to set all the HTTP related parameters.
                </p>
<p>
                    The full description of all the HTTP related parameters that you can
                    set can be found in the javadoc for the
                    <code>WebRequest</code>
                    interface. You should also check the examples provided as part of the
                    Cactus distribution.
                </p>
<p>
                    The <code>beginXXX()</code> methods are executed on the client
                    side, prior to executing <code>testXXX()</code> on the server side
                    and thus, do not have access to any of the class variables that
                    represent API objects (their values are <code>null</code>)
                </p>
</div>
<anchor id="endxxx"><div class="section"><h2><a name="Step_7_optional:_endXXX_methods"></a>Step 7 (optional): endXXX() methods</h2>
<p>
                    For each XXX test case, you can define a corresponding
                    <code>endXXX()</code>
                    method. You will use this method to
                    verify the returned HTTP related parameters from your test case
                    (like the returned content of the HTTP response, any returned
                    cookies, returned HTTP headers, ...).
                </p>
<p>
                    For versions of Cactus up to v1.1, the signature of the end
                    method is:
                </p>
<div class="source"><pre>
public void endXXX(HttpURLConnection theConnection)
{
  [...]
}
</pre>
</div>
<p>
                    ... and some helper methods to extract the response content and
                    cookies were provided in the <code>AssertUtils</code> class
                    (see javadoc).
                </p>
<p>
                    However, beginning with Cactus 1.2, this signature has been
                    deprecated. There are now 2 possible signatures for the end
                    method, depending on whether you need to perform sophisticated
                    checks on the content of what is returned or not. For complex
                    checking, we have integrated with the
                    <a href="http://httpunit.sourceforge.net" class="externalLink">HttpUnit</a>
                    framework. See the
                    <a href="howto_httpunit.html">HttpUnit tutorial</a>
                    for the
                    end method signatures and a full description.
                </p>
<p>
                    The <code>endXXX()</code> methods are executed on the client
                    side, after executing <code>testXXX()</code> on the server side
                    and thus, do not have access to any of the class variables that
                    represent API objects (their values are <code>null</code>)
                </p>
</div>
</div>
<anchor id="specific_details"><div class="section"><h2><a name="TestCase_specific_details"></a>TestCase specific details</h2>
<p><strong>Before reading any of the following detailed tutorials,
                    make sure you have read the previous general principles.
                </strong></p>
<ul><li><a href="howto_testcase_servlet.html">ServletTestCase
                        principles</a>,
                </li>
<li><a href="howto_testcase_jsp.html">JspTestCase
                        principles</a>,
                </li>
<li><a href="howto_testcase_filter.html">FilterTestCase
                        principles
                    </a></li>
</ul>
</div>

      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">&#169;  
          2001-2016
    
          The Apache Software Foundation
          
  

  
    
  
  
    
  </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
