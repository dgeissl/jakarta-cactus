<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">











<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Jakarta Cactus - VAJava and WebSphere Test Environment</title>
    <style type="text/css" media="all">
      @import url("../css/maven-base.css");
      @import url("../css/maven-theme.css");
      @import url("../css/site.css");
    </style>
    <link rel="stylesheet" href="../css/print.css" type="text/css" media="print" />
          </head>
  <body class="composite">
    <div id="banner">
                  <a href="http://jakarta.apache.org/cactus/" id="bannerLeft">
    
                                            <img src="../images/logocactus.gif" alt="" />
    
            </a>
                        <a href="http://jakarta.apache.org/" id="bannerRight">
    
                                            <img src="../images/jakarta-logo.gif" alt="" />
    
            </a>
            <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
          
  

  
    
  
  
    
            <div class="xleft">
        Last Published: 2016-11-27
                          |   
                <a href="http://www.apache.org/" class="externalLink">Apache</a>
                &gt;
      
                <a href="http://www.jakarta.apache.org/" class="externalLink">Jakarta</a>
                &gt;
      
                <a href="http://jakarta.apache.org/cactus/" class="externalLink">Cactus</a>
                          </div>
            <div class="xright">      
  

  
    
  
  
    
  </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
           
  

  
    
  
  
    
                   <h5>About</h5>
            <ul>
              
    <li class="none">
                    <a href="../index.html">Overview</a>
          </li>
              
    <li class="none">
                    <a href="../goals.html">Goals</a>
          </li>
              
    <li class="none">
                    <a href="../features.html">Features</a>
          </li>
              
    <li class="none">
                    <a href="../news.html">News</a>
          </li>
              
    <li class="none">
                    <a href="../downloads.html">Downloads</a>
          </li>
              
    <li class="none">
                    <a href="http://issues.apache.org/jira/secure/BrowseProject.jspa?id=10471" class="externalLink">Bug Database</a>
          </li>
              
    <li class="none">
                    <a href="../mail-lists.html">Mailing Lists</a>
          </li>
              
    <li class="none">
                    <a href="../faq.html">FAQ</a>
          </li>
              
    <li class="none">
                    <a href="http://wiki.apache.org/jakarta-cactus/FrontPage" class="externalLink">Wiki</a>
          </li>
              
    <li class="none">
                    <a href="../license.html">License</a>
          </li>
          </ul>
              <h5>Documentation</h5>
            <ul>
              
    <li class="none">
                    <a href="../getting_started.html">Getting started</a>
          </li>
              
    <li class="none">
                    <a href="../how_it_works.html">How it works</a>
          </li>
              
                
              
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
              
        <li class="collapsed">
                    <a href="../writing/howto_ejb.html">Writing tests</a>
                </li>
              
                
              
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
                  
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
                  
      
            
      
            
      
                  
      
            
      
            
      
              
        <li class="collapsed">
                    <a href="../integration/index.html">Running tests</a>
                </li>
              
                
              
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
              
        <li class="collapsed">
                    <a href="../participating/index.html">Participating</a>
                </li>
          </ul>
              <h5>Miscellaneous</h5>
            <ul>
              
    <li class="none">
                    <a href="../cactusname.html">Why the name</a>
          </li>
              
    <li class="none">
                    <a href="../mock_vs_cactus.html">Mock vs Container</a>
          </li>
              
    <li class="none">
                    <a href="http://wiki.apache.org/jakarta-cactus/TestedOn" class="externalLink">Tested On...</a>
          </li>
              
                
              
      
            
      
            
      
            
      
            
      
              
        <li class="collapsed">
                    <a href="../resources/index.html">Resources</a>
                </li>
          </ul>
              <h5>Translations</h5>
            <ul>
              
    <li class="none">
                    <a href="http://www.ressources-java.net/cactus" class="externalLink">French</a>
          </li>
              
    <li class="none">
                    <a href="http://jakarta.apache-korea.org/cactus/index.html" class="externalLink">Korean</a>
          </li>
              
    <li class="none">
                    <a href="http://www.jajakarta.org/cactus/" class="externalLink">Japanese</a>
          </li>
          </ul>
              <h5>See also</h5>
            <ul>
              
    <li class="none">
                    <a href="http://www.apachebookstore.com/" class="externalLink">Apache Bookstore</a>
          </li>
              
    <li class="none">
                    <a href="http://www.planetapache.org/" class="externalLink">Planet Apache</a>
          </li>
              
    <li class="none">
                    <a href="http://apache.org/foundation/thanks.html" class="externalLink">Apache Sponsors</a>
          </li>
          </ul>
                                                 
                        
                        
            <a href="http://jakarta.apache.org/cactus/" title="Jakarta Cactus" class="poweredBy">
                            <img alt="Jakarta Cactus" src="../images/cactusbanner.gif" />
            </a>
                               
  

  
    
  
  
    
        </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
        <div class="section"><h2><a name="Forewords_and_Requirements"></a>Forewords and Requirements</h2>
<note><strong>This tutorial is written for Cactus 1.2 only. It will need
                    to adapted if you're using Cactus 1.3
                </strong></note><p>
                This tutorial explains how to run Cactus tests within VisualAge for
                Java WebSphere Test Environment.
            </p>
<p>
                We have received reports that the following tutorial works with
                VAJava 3.5.2 and 3.5.3. Please tell us if you find that it works with
                other versions.
            </p>
</div>
<div class="section"><h2><a name="Step_1:_Import_the_correct_packages_in_VAJava"></a>Step 1: Import the correct packages in VAJava</h2>
<p>
                Let's assume the following conventions:
                <strong><code>{Cactus dir}</code></strong>
                is the directory where you
                have unzipped the Cactus distribution or sources and
                <strong><code>{VAJava dir}</code></strong>
                is the directory where
                VAJava is installed. Let's also define
                <strong><code>{WTE dir}</code></strong>
                to be the WebSphere Test Environment directories, i.e.
                <code>{VAJava dir}/ide/project_resources/IBM WebSphere Test
                    Environment</code>.
            </p>
<p>
                You need to create 4 projects: one for JUnit, one for Cactus (
                let's call it &quot;Cactus&quot;), one for HttpClient and
                optionally one for Log4j. Note that the Log4j one is useful only if
                wish to get some Cactus runtime logs. If you don't import the Log4j
                classes, some Cactus classes will appear with a red cross in VAJava
                but you can safely ignore them as they won't be executed.
            </p>
<note>
                You can either import the source files or the compiled classes as you
                wish. If you import the source file, you should import the following
                directories: <code>{Cactus dir}/src/framework/servlet22</code> and
                <code>{Cactus dir}/src/framework/share</code>. You also need to
                copy the following files into
                <code>{VAJava dir}/ide/project_resources/Cactus</code>:
                <code>log_client.properties</code>
                and
                <code>log_server.properties</code>
                which are located in
                <code>{Cactus dir}/sample/conf/test</code>. If you have imported from
                the Cactus jar file, and you have selected to import resources files
                then they have been automatically imported for you.
            </note></div>
<div class="section"><h2><a name="Step_2:_Set_up_the_cactus.properties_file"></a>Step 2: Set up the cactus.properties file</h2>
<p>
                Copy your <code>cactus.properties</code> file (see the
                <a href="manual/howto_config.html">Configuration Howto</a>
                tutorial for details on <code>cactus.properties</code>) to
                <code>{VAJava dir}/ide/project_resources/Cactus</code>.
            </p>
<note>
                As WebSphere does not support the <code>jsp-file</code> tag in
                <code>web.xml</code>, we cannot map the redirector JSP to a name, so
                instead of writing
                &quot;<code>cactus.jspRedirectorURL =
                http://localhost:8080/test/JspRedirector</code>&quot; in
                <code>cactus.properties</code>, you should simply
                put the JSP file name, as in
                &quot;<code>cactus.jspRedirectorURL =
                http://localhost:8080/test/jspRedirector.jsp</code>&quot;. This is only needed
                if you have test cases that extend <code>JspTestCase</code>.
            </note></div>
<div class="section"><h2><a name="Step_3:_Modify_WebSphere_Test_Environment"></a>Step 3: Modify WebSphere Test Environment</h2>
<div class="section"><h2><a name="Edit_default.servlet_engine"></a>Edit default.servlet_engine</h2>
<p>
                    Edit <code>{WTE dir}/properties/default.servlet_engine</code> and
                    add the following under the <code>default_app</code> webgroup:
                </p>
<div class="source"><pre>
    &lt;websphere-webgroup name=&quot;test&quot;&gt;
       &lt;description&gt;Cactus Testing Web Application&lt;/description&gt;
       &lt;document-root&gt;$approot$/web&lt;/document-root&gt;
       &lt;classpath&gt;$approot$/servlets&lt;/classpath&gt;
       &lt;root-uri&gt;/test&lt;/root-uri&gt;
       &lt;auto-reload enabled=&quot;true&quot; polling-interval=&quot;3000&quot;/&gt;
       &lt;shared-context&gt;false&lt;/shared-context&gt;
    &lt;/websphere-webgroup&gt;
</pre>
</div>
<note>
                    The <code>init-parameter</code> is only needed if you wish to run
                    sample application provided in the Cactus distribution. Also, in
                    order to run this sample application you'll need to copy the
                    <code>{Cactus dir}/sample/web/test/test.jsp</code>
                    file to
                    <code>{WTE dir}/hosts/default_host/test/web/test</code>
                    as it is
                    used by a test case.
                </note></div>
<div class="section"><h2><a name="Create_a_test_directory"></a>Create a test directory</h2>
<p>
                    Create a directory called <code>test</code> under
                    <code>{WTE dir}/hosts/default_host</code>. Under
                    <code>test</code>
                    create another 2 subdirectories: <code>servlets</code> and
                    <code>web</code>.
                </p>
</div>
<div class="section"><h2><a name="Create_a_test.webapp_file"></a>Create a test.webapp file</h2>
<p>
                    Create a test.webapp file in
                    <code>{WTE dir}/hosts/default_host/test/servlets</code>
                    and put the
                    following content:
                </p>
<div class="source"><pre>
&lt;?xml version=&quot;1.0&quot;?&gt;
&lt;webapp&gt;
   &lt;name&gt;test&lt;/name&gt;
   &lt;description&gt;Cactus testing web application&lt;/description&gt;
   &lt;error-page&gt;/ErrorReporter&lt;/error-page&gt;

   &lt;servlet&gt;
      &lt;name&gt;ServletRedirector&lt;/name&gt;
      &lt;description&gt;Cactus Testing ServletRedirector&lt;/description&gt;
      &lt;code&gt;org.apache.cactus.server.ServletTestRedirector&lt;/code&gt;
      &lt;servlet-path&gt;/ServletRedirector&lt;/servlet-path&gt;
      &lt;autostart&gt;false&lt;/autostart&gt;
      &lt;init-parameter&gt;
        &lt;name&gt;param1&lt;/name&gt;
        &lt;value&gt;value1 used for testing&lt;/value&gt;
    &lt;/init-parameter&gt;
   &lt;/servlet&gt;

   &lt;!-- Note: We don't provide a mapping for the JSP Redirector because
        WebSphere does not support the jsp-file tag of the Servlet 2.2
        specification --&gt;

   &lt;servlet&gt;
      &lt;name&gt;ErrorReporter&lt;/name&gt;
      &lt;description&gt;Default error reporter servlet&lt;/description&gt;
      &lt;code&gt;com.ibm.servlet.engine.webapp.DefaultErrorReporter&lt;/code&gt;
      &lt;servlet-path&gt;/ErrorReporter&lt;/servlet-path&gt;
      &lt;autostart&gt;true&lt;/autostart&gt;
   &lt;/servlet&gt;

   &lt;servlet&gt;
      &lt;name&gt;jsp&lt;/name&gt;
      &lt;description&gt;JSP support servlet&lt;/description&gt;

      &lt;!--
        WARNING:

        If you use the JSP 1.0 compiler, use the following
          &lt;code&gt;com.ibm.ivj.jsp.runtime.JspDebugServlet&lt;/code&gt;

        If you use the JSP 1.1 compiler (VAJava 3.5.3 only), use the following
          &lt;code&gt;com.ibm.ivj.jsp.jasper.runtime.JspDebugServlet&lt;/code&gt;
      --&gt;
      &lt;code&gt;com.ibm.ivj.jsp.jasper.runtime.JspDebugServlet&lt;/code&gt;

      &lt;init-parameter&gt;
         &lt;name&gt;workingDir&lt;/name&gt;
         &lt;value&gt;$server_root$/temp/default_app&lt;/value&gt;
      &lt;/init-parameter&gt;
      &lt;init-parameter&gt;
         &lt;name&gt;jspemEnabled&lt;/name&gt;
         &lt;value&gt;true&lt;/value&gt;
      &lt;/init-parameter&gt;
      &lt;init-parameter&gt;
         &lt;name&gt;scratchdir&lt;/name&gt;
         &lt;value&gt;$server_root$/temp/JSP1_1/default_app&lt;/value&gt;
      &lt;/init-parameter&gt;
      &lt;init-parameter&gt;
         &lt;name&gt;keepgenerated&lt;/name&gt;
         &lt;value&gt;true&lt;/value&gt;
      &lt;/init-parameter&gt;
      &lt;autostart&gt;true&lt;/autostart&gt;
      &lt;servlet-path&gt;*.jsp&lt;/servlet-path&gt;
   &lt;/servlet&gt;

   &lt;servlet&gt;
      &lt;name&gt;file&lt;/name&gt;
      &lt;description&gt;File serving servlet&lt;/description&gt;
      &lt;code&gt;com.ibm.servlet.engine.webapp.SimpleFileServlet&lt;/code&gt;
      &lt;servlet-path&gt;/&lt;/servlet-path&gt;
      &lt;init-parameter&gt;
         &lt;name&gt;&lt;/name&gt;
         &lt;value&gt;&lt;/value&gt;
      &lt;/init-parameter&gt;
      &lt;autostart&gt;true&lt;/autostart&gt;
   &lt;/servlet&gt;
&lt;/webapp&gt;
</pre>
</div>
</div>
<div class="section"><h2><a name="Copy_the_Cactus_JSP_Redirector_file"></a>Copy the Cactus JSP Redirector file</h2>
<p>
                    Copy the
                    <code>{Cactus dir}/sample/web/test/jspRedirector.jsp</code>
                    file to <code>{WTE dir}/hosts/default_host/test/web</code>.
                </p>
</div>
</div>
<div class="section"><h2><a name="Step_4:_Edit_VAJava_workspace_classpath"></a>Step 4: Edit VAJava workspace classpath</h2>
<p>
                Add the following to the VAJava workspace classpath (select menu
                &quot;Window... | Resources&quot; under VAJava):
            </p>
<div class="source"><pre>
{VAJava dir}\ide\project_resources\JUnit\;
{VAJava dir}\ide\project_resources\Cactus\;
{VAJava dir}\ide\project_resources\HttpClient\;
{VAJava dir}\ide\project_resources\Log4j\;
{VAJava dir}\ide\project_resources\Servlet API Classes\;
</pre>
</div>
</div>
<div class="section"><h2><a name="Step_5:_Edit_VAJava_workspace_classpath"></a>Step 5: Edit VAJava workspace classpath</h2>
<p>
                In the WebSphere Test Environment under Servlet Engine, add Cactus,
                JUnit, HttpClient, Log4j, and the project that contained the tests to
                the classpath.
            </p>
</div>
<div class="section"><h2><a name="Final_note"></a>Final note</h2>
<note>
                With this configuration, you'll find
                <code>cactus_client.log</code>
                under <code>{VAJava dir}/ide/project_resources/{project being
                tested}
            </code> and <code>cactus_server.log</code> under
                <code>{VAJava dir}/ide/tools/com-ibm-ivj-ui-webcontrolcenter</code>
                when you run your tests.
            </note><note>
                If you get a &quot;Failed to invoke suite():
                java.lang.NoClassDefFoundError&quot; error message, you msy get around that
                problem by explicitly adding the test cases to the TestSuite that's
                returned in suite(), for your test case.
            </note></div>

      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">&#169;  
          2001-2016
    
          The Apache Software Foundation
          
  

  
    
  
  
    
  </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
