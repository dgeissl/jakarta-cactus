<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">











<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Jakarta Cactus - Tomcat Quickstart</title>
    <style type="text/css" media="all">
      @import url("../css/maven-base.css");
      @import url("../css/maven-theme.css");
      @import url("../css/site.css");
    </style>
    <link rel="stylesheet" href="../css/print.css" type="text/css" media="print" />
          </head>
  <body class="composite">
    <div id="banner">
                  <a href="http://jakarta.apache.org/cactus/" id="bannerLeft">
    
                                            <img src="../images/logocactus.gif" alt="" />
    
            </a>
                        <a href="http://jakarta.apache.org/" id="bannerRight">
    
                                            <img src="../images/jakarta-logo.gif" alt="" />
    
            </a>
            <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
          
  

  
    
  
  
    
            <div class="xleft">
        Last Published: 2016-11-27
                          |   
                <a href="http://www.apache.org/" class="externalLink">Apache</a>
                &gt;
      
                <a href="http://www.jakarta.apache.org/" class="externalLink">Jakarta</a>
                &gt;
      
                <a href="http://jakarta.apache.org/cactus/" class="externalLink">Cactus</a>
                          </div>
            <div class="xright">      
  

  
    
  
  
    
  </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
           
  

  
    
  
  
    
                   <h5>About</h5>
            <ul>
              
    <li class="none">
                    <a href="../index.html">Overview</a>
          </li>
              
    <li class="none">
                    <a href="../goals.html">Goals</a>
          </li>
              
    <li class="none">
                    <a href="../features.html">Features</a>
          </li>
              
    <li class="none">
                    <a href="../news.html">News</a>
          </li>
              
    <li class="none">
                    <a href="../downloads.html">Downloads</a>
          </li>
              
    <li class="none">
                    <a href="http://issues.apache.org/jira/secure/BrowseProject.jspa?id=10471" class="externalLink">Bug Database</a>
          </li>
              
    <li class="none">
                    <a href="../mail-lists.html">Mailing Lists</a>
          </li>
              
    <li class="none">
                    <a href="../faq.html">FAQ</a>
          </li>
              
    <li class="none">
                    <a href="http://wiki.apache.org/jakarta-cactus/FrontPage" class="externalLink">Wiki</a>
          </li>
              
    <li class="none">
                    <a href="../license.html">License</a>
          </li>
          </ul>
              <h5>Documentation</h5>
            <ul>
              
    <li class="none">
                    <a href="../getting_started.html">Getting started</a>
          </li>
              
    <li class="none">
                    <a href="../how_it_works.html">How it works</a>
          </li>
              
                
              
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
              
        <li class="collapsed">
                    <a href="../writing/howto_ejb.html">Writing tests</a>
                </li>
              
                
              
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
                  
      
            
            
            
      
            
      
            
      
            
      
            
      
            
      
                  
      
            
      
            
      
                  
      
            
      
            
      
              
            <li class="expanded">
                    <a href="../integration/index.html">Running tests</a>
                  <ul>
                  
    <li class="none">
                    <a href="../integration/manual/index.html">Manual</a>
          </li>
                  
    <li class="none">
                    <a href="../integration/eclipse/index.html">Eclipse</a>
          </li>
                  
                
              
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
              
        <li class="collapsed">
                    <a href="../integration/ant/index.html">Ant</a>
                </li>
                  
    <li class="none">
                    <a href="../integration/integration_browser.html">Browser</a>
          </li>
                  
    <li class="none">
              <strong>Tomcat</strong>
        </li>
                  
                
              
      
            
      
            
      
            
      
            
      
              
        <li class="collapsed">
                    <a href="../integration/maven/index.html">Maven</a>
                </li>
                  
                
              
      
            
      
              
        <li class="collapsed">
                    <a href="../integration/maven2/index.html">Maven2</a>
                </li>
                  
    <li class="none">
                    <a href="../integration/integration_jetty.html">Jetty</a>
          </li>
                  
    <li class="none">
                    <a href="../integration/howto_ide.html">Various IDEs</a>
          </li>
                  
    <li class="none">
                    <a href="../integration/howto_junitee.html">JUnitEE</a>
          </li>
              </ul>
        </li>
              
                
              
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
              
        <li class="collapsed">
                    <a href="../participating/index.html">Participating</a>
                </li>
          </ul>
              <h5>Miscellaneous</h5>
            <ul>
              
    <li class="none">
                    <a href="../cactusname.html">Why the name</a>
          </li>
              
    <li class="none">
                    <a href="../mock_vs_cactus.html">Mock vs Container</a>
          </li>
              
    <li class="none">
                    <a href="http://wiki.apache.org/jakarta-cactus/TestedOn" class="externalLink">Tested On...</a>
          </li>
              
                
              
      
            
      
            
      
            
      
            
      
              
        <li class="collapsed">
                    <a href="../resources/index.html">Resources</a>
                </li>
          </ul>
              <h5>Translations</h5>
            <ul>
              
    <li class="none">
                    <a href="http://www.ressources-java.net/cactus" class="externalLink">French</a>
          </li>
              
    <li class="none">
                    <a href="http://jakarta.apache-korea.org/cactus/index.html" class="externalLink">Korean</a>
          </li>
              
    <li class="none">
                    <a href="http://www.jajakarta.org/cactus/" class="externalLink">Japanese</a>
          </li>
          </ul>
              <h5>See also</h5>
            <ul>
              
    <li class="none">
                    <a href="http://www.apachebookstore.com/" class="externalLink">Apache Bookstore</a>
          </li>
              
    <li class="none">
                    <a href="http://www.planetapache.org/" class="externalLink">Planet Apache</a>
          </li>
              
    <li class="none">
                    <a href="http://apache.org/foundation/thanks.html" class="externalLink">Apache Sponsors</a>
          </li>
          </ul>
                                                 
                        
                        
            <a href="http://jakarta.apache.org/cactus/" title="Jakarta Cactus" class="poweredBy">
                            <img alt="Jakarta Cactus" src="../images/cactusbanner.gif" />
            </a>
                               
  

  
    
  
  
    
        </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
        <div class="section"><h2><a name="Tomcat_Quickstart_forewords"></a>Tomcat Quickstart forewords</h2>
<note>
                This tutorial applies to Cactus 1.4 or greater and Tomcat 4.0 or
                greater.
            </note><p>
                This document is a step by step tutorial that explains how to set up
                Cactus and run Cactus tests in Tomcat in less than 10 minutes !
                (discounting download time of course :-)).
            </p>
<p>
                There are 2 ways of packaging Cactus so that you can execute Cactus
                tests on your application:
            </p>
<ul><li>
                    By putting all Cactus jars in your <code>WEB-INF/lib</code> directory,
                    as described in the <a href="manual/howto_classpath.html">Classpath
                    Tutorial</a>,
                </li>
<li>
                    By putting the Cactus jars in your container classpath so that Cactus
                    will load them using the container Context class loader. This
                    tutorial will describe this strategy as it is the less intrusive one
                    and provides reuse of Cactus jars across several webapps.
                </li>
</ul>
<p>
                In addition to this, there are several ways to trigger the execution of
                the Cactus tests (see the <a href="index.html">TestRunner
                Howto
            </a> tutorial). We will describe the easiest one to set up in
                this tutorial, which is by using a browser.
            </p>
<note>
                Step 1 to step 3 are a one time install steps that you need to perform
                only once to be able to run Cactus tests within Tomcat.
            </note></div>
<div class="section"><h2><a name="Step_1:_Install_Tomcat"></a>Step 1: Install Tomcat</h2>
<p>
                Download
                <a href="http://jakarta.apache.org/builds/jakarta-tomcat-4.0/release/" class="externalLink">Tomcat</a>
                4.0 or greater and unzip it in any directory. Let's call this directory
                <code>[tomcat-root]</code>.
            </p>
</div>
<div class="section"><h2><a name="Step_2_:_Copy_the_Cactus_jars"></a>Step 2 : Copy the Cactus jars</h2>
<p>
                Download the Cactus jars from the <a href="../downloads.html">Cactus
                download page</a>. They are located in the
                <code>lib/</code>
                directory in the zip.
            </p>
<p>
                Copy the following jars to <code>[tomcat-root]/common/lib</code>:
            </p>
<ul><li><code>cactus.jar</code></li>
<li><code>commons-httpclient.jar</code></li>
<li><code>commons-logging.jar</code></li>
<li><code>junit.jar</code></li>
<li><code>aspectjrt.jar</code></li>
</ul>
<note>
                This is the minium set of jars needed. If later on you wish to use the
                Cactus
                <a href="../writing/howto_httpunit.html">HttpUnit integration</a>
                you'll also need to copy <code>httpunit.jar</code>.
            </note></div>
<div class="section"><h2><a name="Step_3:_Modify_Tomcat_web.xml"></a>Step 3: Modify Tomcat web.xml</h2>
<p>
                Edit <code>[tomcat-root]/conf/web.xml</code> and add the following at
                the beginning of the file, after the <code>&lt;webapp&gt;</code> tag:
            </p>
<div class="source"><pre>
&lt;servlet&gt;
  &lt;servlet-name&gt;ServletRedirector&lt;/servlet-name&gt;
  &lt;servlet-class&gt;org.apache.cactus.server.ServletTestRedirector&lt;/servlet-class&gt;
  &lt;init-param&gt;
    &lt;param-name&gt;param1&lt;/param-name&gt;
    &lt;param-value&gt;value1 used for testing&lt;/param-value&gt;
  &lt;/init-param&gt;
&lt;/servlet&gt;

&lt;servlet&gt;
  &lt;servlet-name&gt;ServletTestRunner&lt;/servlet-name&gt;
  &lt;servlet-class&gt;org.apache.cactus.server.runner.ServletTestRunner&lt;/servlet-class&gt;
&lt;/servlet&gt;
</pre>
</div>
<p>
                Then, after the last <code>&lt;servlet&gt;</code> definition (there
                are a few provided by Tomcat in addition to our 2 above), add:
            </p>
<div class="source"><pre>
&lt;servlet-mapping&gt;
    &lt;servlet-name&gt;ServletRedirector&lt;/servlet-name&gt;
    &lt;url-pattern&gt;/ServletRedirector&lt;/url-pattern&gt;
&lt;/servlet-mapping&gt;

&lt;servlet-mapping&gt;
    &lt;servlet-name&gt;ServletTestRunner&lt;/servlet-name&gt;
    &lt;url-pattern&gt;/ServletTestRunner&lt;/url-pattern&gt;
&lt;/servlet-mapping&gt;
</pre>
</div>
<note><strong>Warning</strong>: Be careful when you modify the global
                Tomcat <code>web.xml</code> file. If later on you wish to use
                the Cactus Ant integration and more specifically if you use the
                <code>&lt;cactifywar&gt;</code>
                Ant task, you may run into problems.
                The <code>&lt;cactifywar&gt;</code> task automatically adds the
                needed Cactus redirectors (thus they'll be added twice leading to
                an error.
            </note></div>
<div class="section"><h2><a name="Step_4:_Creating_a_sample_applicaton_to_test"></a>Step 4: Creating a sample applicaton to test</h2>
<p>
                We're now going to create a very very simple application to server
                so that we can unit test it.
            </p>
<p>
                First, create the following directory structure:
            </p>
<div class="source"><pre>
[tomcat-root]/webapps
  |_ test
    |_ WEB-INF
      |_ classes
</pre>
</div>
<p>
                Then, create the following <code>SampleServlet.java</code> java source
                file, compile it and copy the resulting .class file in
                <code>[tomcat-root]/webapps/test/WEB-INF/classes</code>.
            </p>
<div class="source"><pre>
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;

public class SampleServlet extends HttpServlet
{
    public void saveToSession(HttpServletRequest request)
    {
    	String testparam = request.getParameter(&quot;testparam&quot;);
    	request.getSession().setAttribute(&quot;testAttribute&quot;, testparam);
    }
}
</pre>
</div>
<note>
                You'll notice that this isn't even a finished servlet ! However, this
                shows that you can start testing your code with Cactus even before
                you have finished writing it completely. Extreme Programmers should
                like this :-)
            </note><p>
                We're now read to create our first Cactus test case. Create the
                following <code>TestSampleServlet.java</code> java source file, compile
                it and copy the resulting .class file in
                <code>[tomcat-root]/webapps/test/WEB-INF/classes</code>.
            </p>
<div class="source"><pre>
import junit.framework.Test;
import junit.framework.TestSuite;

import org.apache.cactus.ServletTestCase;
import org.apache.cactus.WebRequest;

public class TestSampleServlet extends ServletTestCase
{
    public TestSampleServlet(String theName)
    {
        super(theName);
    }

    public static Test suite()
    {
        return new TestSuite(TestSampleServlet.class);
    }

    public void beginSaveToSessionOK(WebRequest webRequest)
    {
        webRequest.addParameter(&quot;testparam&quot;, &quot;it works!&quot;);
    }

    public void testSaveToSessionOK()
    {
        SampleServlet servlet = new SampleServlet();
        servlet.saveToSession(request);
        assertEquals(&quot;it works!&quot;, session.getAttribute(&quot;testAttribute&quot;));
    }
}
</pre>
</div>
</div>
<div class="section"><h2><a name="Step_5:_Run_the_test"></a>Step 5: Run the test</h2>
<p>
                Time to enjoy our hard work ! Start Tomcat by running
                <code>[tomcat-root]/bin/startup.bat</code>
                (for windows) or
                <code>[tomcat-root]/bin/startup.sh</code>
                (for unix).
            </p>
<p>
                Open a browser and point it at
                <code>http://localhost:8080/test/ServletTestRunner?suite=TestSampleServlet</code></p>
<p>
                You should see:
            </p>
<p><img src="../images/tomcat_xml.jpg" alt="XML output of ServletTestRunner" /></p>
</div>
<div class="section"><h2><a name="Step_6:_Even_more_fun"></a>Step 6: Even more fun!</h2>
<p>
                Ok, that's nice ... But what if I want HTML instead of XML? Don't
                worry there is a solution. Grab the following
                <a href="../misc/cactus-report.xsl">XSLT stylesheet</a>
                (based on the stylesheet used by the
                <strong>&lt;junitreport&gt;</strong>
                Ant task) and drop it in
                <code>[tomcat-root]/webapps/test</code>. Then, open a browser and type
                <code>
                    http://localhost:8080/test/ServletTestRunner?suite=TestSampleServlet&amp;xsl=cactus-report.xsl
                </code>
                .
                You should now see the following:
            </p>
<p><img src="../images/tomcat_html.jpg" alt="HTML output of ServletTestRunner" /></p>
<note>
                This will work with any browser that supports client-slide XSLT
                transformations (both Internet Explorer and Mozilla do, for example).
            </note></div>

      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">&#169;  
          2001-2016
    
          The Apache Software Foundation
          
  

  
    
  
  
    
  </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
