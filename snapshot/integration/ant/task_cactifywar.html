<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">











<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Jakarta Cactus - CactifyWar Ant Task</title>
    <style type="text/css" media="all">
      @import url("../../css/maven-base.css");
      @import url("../../css/maven-theme.css");
      @import url("../../css/site.css");
    </style>
    <link rel="stylesheet" href="../../css/print.css" type="text/css" media="print" />
          </head>
  <body class="composite">
    <div id="banner">
                  <a href="http://jakarta.apache.org/cactus/" id="bannerLeft">
    
                                            <img src="../../images/logocactus.gif" alt="" />
    
            </a>
                        <a href="http://jakarta.apache.org/" id="bannerRight">
    
                                            <img src="../../images/jakarta-logo.gif" alt="" />
    
            </a>
            <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
          
  

  
    
  
  
    
            <div class="xleft">
        Last Published: 2016-11-27
                          |   
                <a href="http://www.apache.org/" class="externalLink">Apache</a>
                &gt;
      
                <a href="http://www.jakarta.apache.org/" class="externalLink">Jakarta</a>
                &gt;
      
                <a href="http://jakarta.apache.org/cactus/" class="externalLink">Cactus</a>
                          </div>
            <div class="xright">      
  

  
    
  
  
    
  </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
           
  

  
    
  
  
    
                   <h5>About</h5>
            <ul>
              
    <li class="none">
                    <a href="../../index.html">Overview</a>
          </li>
              
    <li class="none">
                    <a href="../../goals.html">Goals</a>
          </li>
              
    <li class="none">
                    <a href="../../features.html">Features</a>
          </li>
              
    <li class="none">
                    <a href="../../news.html">News</a>
          </li>
              
    <li class="none">
                    <a href="../../downloads.html">Downloads</a>
          </li>
              
    <li class="none">
                    <a href="http://issues.apache.org/jira/secure/BrowseProject.jspa?id=10471" class="externalLink">Bug Database</a>
          </li>
              
    <li class="none">
                    <a href="../../mail-lists.html">Mailing Lists</a>
          </li>
              
    <li class="none">
                    <a href="../../faq.html">FAQ</a>
          </li>
              
    <li class="none">
                    <a href="http://wiki.apache.org/jakarta-cactus/FrontPage" class="externalLink">Wiki</a>
          </li>
              
    <li class="none">
                    <a href="../../license.html">License</a>
          </li>
          </ul>
              <h5>Documentation</h5>
            <ul>
              
    <li class="none">
                    <a href="../../getting_started.html">Getting started</a>
          </li>
              
    <li class="none">
                    <a href="../../how_it_works.html">How it works</a>
          </li>
              
                
              
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
              
        <li class="collapsed">
                    <a href="../../writing/howto_ejb.html">Writing tests</a>
                </li>
              
                
              
      
            
      
            
      
            
      
            
      
            
      
            
      
            
            
            
      
            
      
            
      
            
      
            
      
                  
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
                  
      
            
      
            
      
                  
      
            
      
            
      
              
            <li class="expanded">
                    <a href="../../integration/index.html">Running tests</a>
                  <ul>
                  
    <li class="none">
                    <a href="../../integration/manual/index.html">Manual</a>
          </li>
                  
    <li class="none">
                    <a href="../../integration/eclipse/index.html">Eclipse</a>
          </li>
                  
                
              
      
            
      
            
      
            
      
            
            
            
      
            
      
            
      
            
      
            
      
              
            <li class="expanded">
                    <a href="../../integration/ant/index.html">Ant</a>
                  <ul>
                  
    <li class="none">
                    <a href="../../integration/ant/howto_ant_cactus.html">Howto Ant-Cactus</a>
          </li>
                  
    <li class="none">
                    <a href="../../integration/ant/howto_ant_install.html">Howto Ant-Install</a>
          </li>
                  
    <li class="none">
                    <a href="../../integration/ant/howto_ant_primer.html">Howto Ant-Primer</a>
          </li>
                  
    <li class="none">
                    <a href="../../integration/ant/task_cactifyear.html">CactifyEar Task</a>
          </li>
                  
    <li class="none">
              <strong>CactifyWar Task</strong>
        </li>
                  
    <li class="none">
                    <a href="../../integration/ant/task_cactus.html">Cactus Task</a>
          </li>
                  
    <li class="none">
                    <a href="../../integration/ant/task_cactus1.8.html">Cactus Task 1.8</a>
          </li>
                  
    <li class="none">
                    <a href="../../integration/ant/task_resin.html">Resin Task</a>
          </li>
                  
    <li class="none">
                    <a href="../../integration/ant/task_runservertests.html">RunServerTests Task</a>
          </li>
                  
    <li class="none">
                    <a href="../../integration/ant/task_webxmlmerge.html">WebXmlMerge Task</a>
          </li>
              </ul>
        </li>
                  
    <li class="none">
                    <a href="../../integration/integration_browser.html">Browser</a>
          </li>
                  
    <li class="none">
                    <a href="../../integration/howto_tomcat.html">Tomcat</a>
          </li>
                  
                
              
      
            
      
            
      
            
      
            
      
              
        <li class="collapsed">
                    <a href="../../integration/maven/index.html">Maven</a>
                </li>
                  
                
              
      
            
      
              
        <li class="collapsed">
                    <a href="../../integration/maven2/index.html">Maven2</a>
                </li>
                  
    <li class="none">
                    <a href="../../integration/integration_jetty.html">Jetty</a>
          </li>
                  
    <li class="none">
                    <a href="../../integration/howto_ide.html">Various IDEs</a>
          </li>
                  
    <li class="none">
                    <a href="../../integration/howto_junitee.html">JUnitEE</a>
          </li>
              </ul>
        </li>
              
                
              
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
              
        <li class="collapsed">
                    <a href="../../participating/index.html">Participating</a>
                </li>
          </ul>
              <h5>Miscellaneous</h5>
            <ul>
              
    <li class="none">
                    <a href="../../cactusname.html">Why the name</a>
          </li>
              
    <li class="none">
                    <a href="../../mock_vs_cactus.html">Mock vs Container</a>
          </li>
              
    <li class="none">
                    <a href="http://wiki.apache.org/jakarta-cactus/TestedOn" class="externalLink">Tested On...</a>
          </li>
              
                
              
      
            
      
            
      
            
      
            
      
              
        <li class="collapsed">
                    <a href="../../resources/index.html">Resources</a>
                </li>
          </ul>
              <h5>Translations</h5>
            <ul>
              
    <li class="none">
                    <a href="http://www.ressources-java.net/cactus" class="externalLink">French</a>
          </li>
              
    <li class="none">
                    <a href="http://jakarta.apache-korea.org/cactus/index.html" class="externalLink">Korean</a>
          </li>
              
    <li class="none">
                    <a href="http://www.jajakarta.org/cactus/" class="externalLink">Japanese</a>
          </li>
          </ul>
              <h5>See also</h5>
            <ul>
              
    <li class="none">
                    <a href="http://www.apachebookstore.com/" class="externalLink">Apache Bookstore</a>
          </li>
              
    <li class="none">
                    <a href="http://www.planetapache.org/" class="externalLink">Planet Apache</a>
          </li>
              
    <li class="none">
                    <a href="http://apache.org/foundation/thanks.html" class="externalLink">Apache Sponsors</a>
          </li>
          </ul>
                                                 
                        
                        
            <a href="http://jakarta.apache.org/cactus/" title="Jakarta Cactus" class="poweredBy">
                            <img alt="Jakarta Cactus" src="../../images/cactusbanner.gif" />
            </a>
                               
  

  
    
  
  
    
        </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
        <div class="section"><h2><a name="CactifyWar_Task"></a>CactifyWar Task</h2>
<p>
                The task <strong>cactifywar</strong> allows the enhancement of an existing
                web-application archive (WAR) with the elements needed to run Cactus
                in-container tests. This includes adding the definitions of the test
                redirectors to the deployment descriptor, as well as adding the libraries
                that Cactus requires on the server side (see the
                <a href="../manual/howto_classpath.html">Classpath Guide</a>
                for details).
            </p>
<note>
                If you want to use the
                <a href="../../writing/howto_httpunit.html">HttpUnit integration</a>
                in your
                tests, you'll need to explicitly add the <code>httpunit.jar</code> to
                the cactified WAR. You can easily do this by using a nested
                <code>&lt;lib&gt;</code>
                element.
            </note><p>
                The <strong>cactifywar</strong> task extends the built-in Ant task
                <strong>war</strong>, so it also supports all attributes and nested
                elements that <strong>war</strong> supports.
            </p>
<div class="section"><h2><a name="Parameters"></a>Parameters</h2>
<p>
                    As this task is an extension of the <strong>war</strong> task, it
                    also supports all the attributes supported by the
                    <strong>war</strong>
                    task. The only exception is the
                    <em>warfile</em>
                    attribute, which has been renamed to
                    <em>destfile</em>
                    for the <strong>cactifywar</strong> task.
                </p>
<table class="bodyTable"><tr class="a"><th>Name</th>
<th>Description</th>
<th>Required</th>
</tr>
<tr class="b"><td><strong>destfile</strong></td>
<td>
                            The location of the cactified web-application archive to create.
                        </td>
<td>Yes</td>
</tr>
<tr class="a"><td>srcfile</td>
<td>
                            The original web-application archive that is going to be
                            cactified. If this attribute is not specified, a new web-app
                            archive will be created. You'll need to specify the
                            <em>version</em>
                            attribute in that case.
                        </td>
<td>No</td>
</tr>
<tr class="b"><td>mergewebxml</td>
<td>
                            Allows the specification of a web deployment descriptor whose
                            content will get merged into the resulting descriptor. This is
                            only required for purposes like adding special security
                            constraints for testing, as the Cactus test redirectors will be
                            added to the cactified deployment descriptor anyway. The merging
                            of the descriptors is based on the same principles as used by the
                            <a href="task_webxmlmerge.html">webxmlmerge</a>
                            task.
                        </td>
<td>No</td>
</tr>
<tr class="a"><td>version</td>
<td>
                            The version of the web application archive to create if no source
                            archive has been specified with the <em>srcfile</em> attribute.
                            Can be either <code>2.2</code> or <code>2.3</code>.
                        </td>
<td>No, unless the <em>srcfile</em> attribute is omitted
                        </td>
</tr>
</table>
</div>
<div class="section"><h2><a name="Nested_Elements"></a>Nested Elements</h2>
<p>
                    As this task is an extension of the <strong>war</strong> task, it
                    also supports all attributes that the <strong>war</strong> task
                    supports. In addition, you can specify the URL-patterns to map the
                    Cactus test redirectors to which the nested elements
                    <strong>filterredirector</strong>, <strong>jspredirector</strong> and
                    <strong>servletredirector</strong>. If you don't specify those
                    elements, the test redirectors will be mapped to the default
                    URL-pattern.
                </p>
<div class="section"><h2><a name="filterredirector"></a>filterredirector</h2>
<p>
                        The <strong>filterredirector</strong> element lets you specify the
                        URL pattern to which the Cactus filter test redirector is mapped in
                        the web application.
                    </p>
<div class="section"><h2><a name="Parameters"></a>Parameters</h2>
<table class="bodyTable"><tr class="b"><th>Name</th>
<th>Description</th>
<th>Required</th>
</tr>
<tr class="a"><td>name</td>
<td>
                                    The name of the filter redirector. Only needed if you want to
                                    add multiple filter redirectors to the deployment descriptor.
                                </td>
<td>No, the default is
                                    <em>FilterRedirector</em></td>
</tr>
<tr class="b"><td>mapping</td>
<td>
                                    The URL-pattern to which the redirector should be mapped.
                                    Must start with a forward slash (&quot;/&quot;).
                                </td>
<td>No, the default is
                                    <em>/FilterRedirector</em></td>
</tr>
<tr class="a"><td>roles</td>
<td>
                                    A comma-separated list of role names which will be granted
                                    access to the redirector. If this attribute is ommitted,
                                    access to the redirector will not be constrained. Unless the
                                    roles are already defined in the deployment descriptor, they
                                    will be added automatically.
                                </td>
<td>No</td>
</tr>
</table>
</div>
<note>
                        This element will be ignored for Servlet 2.2 web applications.
                    </note></div>
<div class="section"><h2><a name="jspredirector"></a>jspredirector</h2>
<p>
                        The <strong>jspredirector</strong> element lets you specify the
                        URL pattern to which the Cactus JSP test redirector is mapped in
                        the web application.
                    </p>
<div class="section"><h2><a name="Parameters"></a>Parameters</h2>
<table class="bodyTable"><tr class="b"><th>Name</th>
<th>Description</th>
<th>Required</th>
</tr>
<tr class="a"><td>name</td>
<td>
                                    The name of the JSP redirector. Only needed if you want to
                                    add multiple JSP redirectors to the deployment descriptor.
                                </td>
<td>No, the default is
                                    <em>JspRedirector</em></td>
</tr>
<tr class="b"><td>mapping</td>
<td>
                                    The URL-pattern to which the redirector should be mapped.
                                    Must start with a forward slash (&quot;/&quot;).
                                </td>
<td>No, the default is
                                    <em>/JspRedirector</em></td>
</tr>
<tr class="a"><td>roles</td>
<td>
                                    A comma-separated list of role names which will be granted
                                    access to the redirector. If this attribute is ommitted,
                                    access to the redirector will not be constrained. Unless the
                                    roles are already defined in the deployment descriptor, they
                                    will be added automatically.
                                </td>
<td>No</td>
</tr>
</table>
</div>
</div>
<div class="section"><h2><a name="servletredirector"></a>servletredirector</h2>
<p>
                        The <strong>servletredirector</strong> element lets you specify the
                        URL pattern to which the Cactus servlet test redirector is mapped in
                        the web application.
                    </p>
<div class="section"><h2><a name="Parameters"></a>Parameters</h2>
<table class="bodyTable"><tr class="b"><th>Name</th>
<th>Description</th>
<th>Required</th>
</tr>
<tr class="a"><td>name</td>
<td>
                                    The name of the servlet redirector. Only needed if you want
                                    to add multiple servlet redirectors to the deployment
                                    descriptor.
                                </td>
<td>No, the default is
                                    <em>ServletRedirector</em></td>
</tr>
<tr class="b"><td>mapping</td>
<td>
                                    The URL-pattern to which the redirector should be mapped.
                                    Must start with a forward slash (&quot;/&quot;).
                                </td>
<td>No, the default is
                                    <em>/ServletRedirector</em></td>
</tr>
<tr class="a"><td>roles</td>
<td>
                                    A comma-separated list of role names which will be granted
                                    access to the redirector. If this attribute is ommitted,
                                    access to the redirector will not be constrained. Unless the
                                    roles are already defined in the deployment descriptor, they
                                    will be added automatically.
                                </td>
<td>No</td>
</tr>
</table>
</div>
</div>
<div class="section"><h2><a name="xmlcatalog"></a>xmlcatalog</h2>
<p>
                        The <code>xmlcatalog</code> element can be used to perform Entity
                        and DTD resolution. This is a built-in Ant type. See the
                        <a href="http://ant.apache.org/manual/index.html" class="externalLink">Ant Manual</a>
                        for details.
                    </p>
<note>
                        The <strong>cactifywar</strong> task resolves the DTDs of web-app
                        descriptors (version 2.2 as well as 2.3) automatically to copies
                        stored in the JAR. So normally, you shouldn't need to specify a
                        nested <code>xmlcatalog</code> element. Further, actually
                        specifying it will disable the default behaviour, and you'll need
                        to provide the web-app DTDs yourself.
                    </note></div>
</div>
<div class="section"><h2><a name="Examples"></a>Examples</h2>
<p>
                    The following example demonstrates the simplest-possible use of the
                    task. It will add the redirectors with the default mappings to the
                    cactified WARs, as well as the Cactus libraries and the JSP page
                    needed for the JSP redirector.
                </p>
<div class="source"><pre>
&lt;cactifywar srcfile=&quot;${build.dir}/my.war&quot; destfile=&quot;${build.dir}/test.war&quot;/&gt;
</pre>
</div>
<p>
                    The next example demonstrates how to modify the mappings of the
                    redirectors.
                </p>
<div class="source"><pre>
&lt;cactifywar srcfile=&quot;${build.dir}/my.war&quot; destfile=&quot;${build.dir}/test.war&quot;&gt;
  &lt;filterredirector mapping=&quot;/test/filterRedirector&quot;/&gt;
  &lt;jspredirector mapping=&quot;/test/jspRedirector&quot;/&gt;
  &lt;servletredirector mapping=&quot;/test/servletRedirector&quot;/&gt;
&lt;/cactifywar&gt;
</pre>
</div>
<p>
                    In the following example, we add the test classes as well as the
                    <a href="../../writing/howto_httpunit.html">HttpUnit</a>
                    library to the
                    cactified WAR.
                </p>
<div class="source"><pre>
&lt;cactifywar srcfile=&quot;${build.dir}/my.war&quot; destfile=&quot;${build.dir}/test.war&quot;&gt;
  &lt;classes dir=&quot;${build.dir}/classes/test&quot; includes=&quot;**/*.class&quot;/&gt;
  &lt;lib file=&quot;${httpunit.jar}&quot;/&gt;
&lt;/cactifywar&gt;
</pre>
</div>
<p>
                    In the next example, we add a security-constrained instance of the
                    servlet redirector to be able to run tests using authentication
                    (see
                    <a href="../../writing/howto_security.html">Using Authentication</a>
                    for details). Note that you need to provide an empty servlet
                    redirector element, so that the default redirector is included
                    along side the secured redirector (it would just be overridden
                    otherwise).
                </p>
<div class="source"><pre>
&lt;cactifywar srcfile=&quot;${build.dir}/my.war&quot; destfile=&quot;${build.dir}/test.war&quot;&gt;
  &lt;servletredirector/&gt;
  &lt;servletredirector name=&quot;ServletRedirectorSecure&quot;
      mapping=&quot;/ServletRedirectorSecure&quot; roles=&quot;test&quot;/&gt;
&lt;/cactifywar&gt;
</pre>
</div>
</div>
</div>

      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">&#169;  
          2001-2016
    
          The Apache Software Foundation
          
  

  
    
  
  
    
  </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
