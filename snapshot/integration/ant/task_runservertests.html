<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">











<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Jakarta Cactus - RunServerTests Ant Task</title>
    <style type="text/css" media="all">
      @import url("../../css/maven-base.css");
      @import url("../../css/maven-theme.css");
      @import url("../../css/site.css");
    </style>
    <link rel="stylesheet" href="../../css/print.css" type="text/css" media="print" />
          </head>
  <body class="composite">
    <div id="banner">
                  <a href="http://jakarta.apache.org/cactus/" id="bannerLeft">
    
                                            <img src="../../images/logocactus.gif" alt="" />
    
            </a>
                        <a href="http://jakarta.apache.org/" id="bannerRight">
    
                                            <img src="../../images/jakarta-logo.gif" alt="" />
    
            </a>
            <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
          
  

  
    
  
  
    
            <div class="xleft">
        Last Published: 2016-11-27
                          |   
                <a href="http://www.apache.org/" class="externalLink">Apache</a>
                &gt;
      
                <a href="http://www.jakarta.apache.org/" class="externalLink">Jakarta</a>
                &gt;
      
                <a href="http://jakarta.apache.org/cactus/" class="externalLink">Cactus</a>
                          </div>
            <div class="xright">      
  

  
    
  
  
    
  </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
           
  

  
    
  
  
    
                   <h5>About</h5>
            <ul>
              
    <li class="none">
                    <a href="../../index.html">Overview</a>
          </li>
              
    <li class="none">
                    <a href="../../goals.html">Goals</a>
          </li>
              
    <li class="none">
                    <a href="../../features.html">Features</a>
          </li>
              
    <li class="none">
                    <a href="../../news.html">News</a>
          </li>
              
    <li class="none">
                    <a href="../../downloads.html">Downloads</a>
          </li>
              
    <li class="none">
                    <a href="http://issues.apache.org/jira/secure/BrowseProject.jspa?id=10471" class="externalLink">Bug Database</a>
          </li>
              
    <li class="none">
                    <a href="../../mail-lists.html">Mailing Lists</a>
          </li>
              
    <li class="none">
                    <a href="../../faq.html">FAQ</a>
          </li>
              
    <li class="none">
                    <a href="http://wiki.apache.org/jakarta-cactus/FrontPage" class="externalLink">Wiki</a>
          </li>
              
    <li class="none">
                    <a href="../../license.html">License</a>
          </li>
          </ul>
              <h5>Documentation</h5>
            <ul>
              
    <li class="none">
                    <a href="../../getting_started.html">Getting started</a>
          </li>
              
    <li class="none">
                    <a href="../../how_it_works.html">How it works</a>
          </li>
              
                
              
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
              
        <li class="collapsed">
                    <a href="../../writing/howto_ejb.html">Writing tests</a>
                </li>
              
                
              
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
            
            
      
                  
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
                  
      
            
      
            
      
                  
      
            
      
            
      
              
            <li class="expanded">
                    <a href="../../integration/index.html">Running tests</a>
                  <ul>
                  
    <li class="none">
                    <a href="../../integration/manual/index.html">Manual</a>
          </li>
                  
    <li class="none">
                    <a href="../../integration/eclipse/index.html">Eclipse</a>
          </li>
                  
                
              
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
            
            
      
              
            <li class="expanded">
                    <a href="../../integration/ant/index.html">Ant</a>
                  <ul>
                  
    <li class="none">
                    <a href="../../integration/ant/howto_ant_cactus.html">Howto Ant-Cactus</a>
          </li>
                  
    <li class="none">
                    <a href="../../integration/ant/howto_ant_install.html">Howto Ant-Install</a>
          </li>
                  
    <li class="none">
                    <a href="../../integration/ant/howto_ant_primer.html">Howto Ant-Primer</a>
          </li>
                  
    <li class="none">
                    <a href="../../integration/ant/task_cactifyear.html">CactifyEar Task</a>
          </li>
                  
    <li class="none">
                    <a href="../../integration/ant/task_cactifywar.html">CactifyWar Task</a>
          </li>
                  
    <li class="none">
                    <a href="../../integration/ant/task_cactus.html">Cactus Task</a>
          </li>
                  
    <li class="none">
                    <a href="../../integration/ant/task_cactus1.8.html">Cactus Task 1.8</a>
          </li>
                  
    <li class="none">
                    <a href="../../integration/ant/task_resin.html">Resin Task</a>
          </li>
                  
    <li class="none">
              <strong>RunServerTests Task</strong>
        </li>
                  
    <li class="none">
                    <a href="../../integration/ant/task_webxmlmerge.html">WebXmlMerge Task</a>
          </li>
              </ul>
        </li>
                  
    <li class="none">
                    <a href="../../integration/integration_browser.html">Browser</a>
          </li>
                  
    <li class="none">
                    <a href="../../integration/howto_tomcat.html">Tomcat</a>
          </li>
                  
                
              
      
            
      
            
      
            
      
            
      
              
        <li class="collapsed">
                    <a href="../../integration/maven/index.html">Maven</a>
                </li>
                  
                
              
      
            
      
              
        <li class="collapsed">
                    <a href="../../integration/maven2/index.html">Maven2</a>
                </li>
                  
    <li class="none">
                    <a href="../../integration/integration_jetty.html">Jetty</a>
          </li>
                  
    <li class="none">
                    <a href="../../integration/howto_ide.html">Various IDEs</a>
          </li>
                  
    <li class="none">
                    <a href="../../integration/howto_junitee.html">JUnitEE</a>
          </li>
              </ul>
        </li>
              
                
              
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
              
        <li class="collapsed">
                    <a href="../../participating/index.html">Participating</a>
                </li>
          </ul>
              <h5>Miscellaneous</h5>
            <ul>
              
    <li class="none">
                    <a href="../../cactusname.html">Why the name</a>
          </li>
              
    <li class="none">
                    <a href="../../mock_vs_cactus.html">Mock vs Container</a>
          </li>
              
    <li class="none">
                    <a href="http://wiki.apache.org/jakarta-cactus/TestedOn" class="externalLink">Tested On...</a>
          </li>
              
                
              
      
            
      
            
      
            
      
            
      
              
        <li class="collapsed">
                    <a href="../../resources/index.html">Resources</a>
                </li>
          </ul>
              <h5>Translations</h5>
            <ul>
              
    <li class="none">
                    <a href="http://www.ressources-java.net/cactus" class="externalLink">French</a>
          </li>
              
    <li class="none">
                    <a href="http://jakarta.apache-korea.org/cactus/index.html" class="externalLink">Korean</a>
          </li>
              
    <li class="none">
                    <a href="http://www.jajakarta.org/cactus/" class="externalLink">Japanese</a>
          </li>
          </ul>
              <h5>See also</h5>
            <ul>
              
    <li class="none">
                    <a href="http://www.apachebookstore.com/" class="externalLink">Apache Bookstore</a>
          </li>
              
    <li class="none">
                    <a href="http://www.planetapache.org/" class="externalLink">Planet Apache</a>
          </li>
              
    <li class="none">
                    <a href="http://apache.org/foundation/thanks.html" class="externalLink">Apache Sponsors</a>
          </li>
          </ul>
                                                 
                        
                        
            <a href="http://jakarta.apache.org/cactus/" title="Jakarta Cactus" class="poweredBy">
                            <img alt="Jakarta Cactus" src="../../images/cactusbanner.gif" />
            </a>
                               
  

  
    
  
  
    
        </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
        <div class="section"><h2><a name="RunServerTests_Task"></a>RunServerTests Task</h2>
<p>
                The <strong>runservertests</strong> task provides support for starting up
                a servlet container to run in-container tests, and shutting it down again
                after the tests have completed.
            </p>
<p>
                This task will perform several actions, in the following order:
            </p>
<ul><li>
                    Check if a server is already started by constantly trying to
                    call the test URL defined by the <code>testurl</code> attribute.
                </li>
<li>
                    If a server is not running, call the Ant target defined by the
                    <code>starttarget</code>
                    attribute. This target is supposed to start
                    your container. The <strong>runservertests</strong> task will then
                    constantly poll the server by calling the test URL until the server
                    answers back.
                </li>
<li>
                    It will then call the Ant target defined by the
                    <code>testtarget</code>
                    attribute. This target is supposed to run the unit tests. This is
                    usually implemented by using the Ant <code>junit</code> task.
                </li>
<li>
                    Once the tests are finished (i.e. when the
                    <code>testtarget</code>
                    has finished executing), it will then
                    call the Ant target defined by the <code>stoptarget</code> attribute.
                    This target is supposed to stop the container. The
                    <strong>runservertests</strong>
                    task will then constantly poll the
                    server by calling the test URL until the server stops answering, at
                    which point it will consider the server to be stopped. Note that the
                    <code>stoptarget</code>
                    will only get called if the server was not
                    already started when the <strong>runservertests</strong> task began
                    executing. This is to allow keeping running servers for intensive
                    debugging phases.
                </li>
</ul>
<p>
                The <strong>runservertests</strong> task is generic in the sense that you
                are free to define the <code>starttarget</code>,
                <code>testtarget</code>
                and <code>stoptarget</code> as you wish and they will get called at the
                right time.
            </p>
<note>
                Since Ant 1.5, the effects of this task can also be achieved by using a
                combination of the built-in Ant tasks <code>waitfor</code> (with the
                <code>http</code>
                condition), <code>parallel</code>,
                <code>sequential</code>
                and <code>antcall</code>.
            </note><div class="section"><h2><a name="Parameters"></a>Parameters</h2>
<table class="bodyTable"><tr class="a"><th>Name</th>
<th>Description</th>
<th>Required</th>
</tr>
<tr class="b"><td>testurl</td>
<td>
                            The HTTP URL to check whether the server is running.
                        </td>
<td>Yes</td>
</tr>
<tr class="a"><td>starttarget</td>
<td>
                            The target that is called when the server needs to be started.
                        </td>
<td>Yes</td>
</tr>
<tr class="b"><td>stoptarget</td>
<td>
                            The target that is called when the server should be shut down.
                        </td>
<td>Yes</td>
</tr>
<tr class="a"><td>testtarget</td>
<td>
                            The target that is called once the server is running. This target
                            will normally perform the actual unit tests.
                        </td>
<td>Yes</td>
</tr>
<tr class="b"><td>timeout</td>
<td>
                            The timeout in seconds. If the server could not be started before
                            the timeout is reached, the task will terminate and report a
                            failure.
                        </td>
<td>No</td>
</tr>
</table>
</div>
<div class="section"><h2><a name="Examples"></a>Examples</h2>
<p>
                    In the following example, the target <code>start.tomcat.40</code> will
                    be called if the specified test URL is not available. After the server
                    has started up so that requests to the test URL return successful HTTP
                    status codes, the target <code>test</code> is called. Finally, after the
                    <code>test</code>
                    target has completed, the target
                    <code>stop.tomcat.40</code>
                    is called to shut down the servlet
                    container.
                </p>
<div class="source"><pre>
&lt;runservertests
    testurl=&quot;http://localhost:${test.port}/test/ServletRedirector?Cactus_Service=RUN_TEST&quot;
    starttarget=&quot;start.tomcat.40&quot;
    stoptarget=&quot;stop.tomcat.40&quot;
    testtarget=&quot;test&quot;/&gt;
</pre>
</div>
</div>
</div>

      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">&#169;  
          2001-2016
    
          The Apache Software Foundation
          
  

  
    
  
  
    
  </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
