<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Generated by Apache Maven Doxia Site Renderer 1.7.1 at 2017-02-26 -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Jakarta Cactus &#x2013; Testing JSP with Cactus</title>
    <style type="text/css" media="all">
      @import url("../css/maven-base.css");
      @import url("../css/maven-theme.css");
      @import url("../css/site.css");
    </style>
    <link rel="stylesheet" href="../css/print.css" type="text/css" media="print" />
    <meta http-equiv="Content-Language" content="en" />
        
        </head>
  <body class="composite">
    <div id="banner">
                                      <a href="../../" id="bannerLeft">
                                                <img src="../images/logocactus.gif" alt="Cactus" />
                </a>
                              <a href="http://jakarta.apache.org/" id="bannerRight">
                                                <img src="../images/jakarta-logo.gif" alt="Apache" />
                </a>
            <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
          
                <div class="xleft">
        <span id="publishDate">Last Published: 2017-02-26</span>
                  &nbsp;| <span id="projectVersion">Version: 1.8.2-SNAPSHOT</span>
                          |                           <a href="http://www.apache.org/" class="externalLink" title="Apache">Apache</a>
        &gt;
                          <a href="http://www.jakarta.apache.org/" class="externalLink" title="Jakarta">Jakarta</a>
        &gt;
                          <a href="../../" title="Cactus">Cactus</a>
        &gt;
    Testing JSP with Cactus
              </div>
            <div class="xright">      
      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
           
                                <h5>About</h5>
                  <ul>
                  <li class="none">
                          <a href="../index.html" title="Overview">Overview</a>
            </li>
                  <li class="none">
                          <a href="../goals.html" title="Goals">Goals</a>
            </li>
                  <li class="none">
                          <a href="../features.html" title="Features">Features</a>
            </li>
                  <li class="none">
                          <a href="../news.html" title="News">News</a>
            </li>
                  <li class="none">
                          <a href="../downloads.html" title="Downloads">Downloads</a>
            </li>
                  <li class="none">
                          <a href="https://github.com/sheeper/jakarta-cactus/issues" class="externalLink" target="_blank" title="Bug Database">Bug Database</a>
            </li>
                  <li class="none">
                          <a href="../mail-lists.html" title="Mailing Lists">Mailing Lists</a>
            </li>
                  <li class="none">
                          <a href="../faq.html" title="FAQ">FAQ</a>
            </li>
                  <li class="none">
                          <a href="http://wiki.apache.org/jakarta-cactus/FrontPage" class="externalLink" target="_blank" title="Wiki">Wiki</a>
            </li>
                  <li class="none">
                          <a href="../license.html" title="License">License</a>
            </li>
          </ul>
                       <h5>Project Documentation</h5>
                  <ul>
                                                                                                                                                                                                                                                                          <li class="collapsed">
                          <a href="../project-info.html" title="Project Information">Project Information</a>
                  </li>
                                                                                                                                            <li class="collapsed">
                          <a href="../project-reports.html" title="Project Reports">Project Reports</a>
                  </li>
          </ul>
                       <h5>Documentation</h5>
                  <ul>
                  <li class="none">
                          <a href="../getting_started.html" title="Getting started">Getting started</a>
            </li>
                  <li class="none">
                          <a href="../how_it_works.html" title="How it works">How it works</a>
            </li>
                                                                                                                                                                                                                                                <li class="expanded">
                          <a href="../writing/howto_ejb.html" title="Writing tests">Writing tests</a>
                    <ul>
                      <li class="none">
                          <a href="../writing/howto_ejb_j2eeri.html" title="Howto EJB">Howto EJB</a>
            </li>
                      <li class="none">
                          <a href="../writing/howto_ejb_3.html" title="Howto EJB3">Howto EJB3</a>
            </li>
                      <li class="none">
                          <a href="../writing/howto_httpunit.html" title="Howto HTTPUnit">Howto HTTPUnit</a>
            </li>
                      <li class="none">
                          <a href="../writing/howto_htmlunit.html" title="Howto HTMLUnit">Howto HTMLUnit</a>
            </li>
                      <li class="none">
            <strong>Howto JSP</strong>
          </li>
                      <li class="none">
                          <a href="../writing/howto_security.html" title="Howto Security">Howto Security</a>
            </li>
                      <li class="none">
                          <a href="../writing/howto_testcase.html" title="Howto TestCase">Howto TestCase</a>
            </li>
                      <li class="none">
                          <a href="../writing/howto_testcase_jsp.html" title="Howto TestCase-JSP">Howto TestCase-JSP</a>
            </li>
                      <li class="none">
                          <a href="../writing/howto_testcase_filter.html" title="Howto TestCase-Filter">Howto TestCase-Filter</a>
            </li>
                      <li class="none">
                          <a href="../writing/howto_testcase_servlet.html" title="Howto TestCase-Servlet">Howto TestCase-Servlet</a>
            </li>
              </ul>
        </li>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          <li class="collapsed">
                          <a href="../integration/index.html" title="Running tests">Running tests</a>
                  </li>
                                                                                                                                                                                                                    <li class="collapsed">
                          <a href="../participating/index.html" title="Participating">Participating</a>
                  </li>
          </ul>
                       <h5>Miscellaneous</h5>
                  <ul>
                  <li class="none">
                          <a href="../cactusname.html" title="Why the name">Why the name</a>
            </li>
                  <li class="none">
                          <a href="../mock_vs_cactus.html" title="Mock vs Container">Mock vs Container</a>
            </li>
                  <li class="none">
                          <a href="http://wiki.apache.org/jakarta-cactus/TestedOn" class="externalLink" title="Tested On...">Tested On...</a>
            </li>
                                                                                                                                            <li class="collapsed">
                          <a href="../resources/index.html" title="Resources">Resources</a>
                  </li>
          </ul>
                       <h5>Translations</h5>
                  <ul>
                  <li class="none">
                          <a href="http://www.ressources-java.net/cactus" class="externalLink" target="_blank" title="French">French</a>
            </li>
                  <li class="none">
                          <a href="http://jakarta.apache-korea.org/cactus/index.html" class="externalLink" target="_blank" title="Korean">Korean</a>
            </li>
                  <li class="none">
                          <a href="http://www.jajakarta.org/cactus/" class="externalLink" target="_blank" title="Japanese">Japanese</a>
            </li>
          </ul>
                       <h5>See also</h5>
                  <ul>
                  <li class="none">
                          <a href="http://www.apachebookstore.com/" class="externalLink" target="_blank" title="Apache Bookstore">Apache Bookstore</a>
            </li>
                  <li class="none">
                          <a href="http://www.planetapache.org/" class="externalLink" target="_blank" title="Planet Apache">Planet Apache</a>
            </li>
                  <li class="none">
                          <a href="http://apache.org/foundation/thanks.html" class="externalLink" target="_blank" title="Apache Sponsors">Apache Sponsors</a>
            </li>
          </ul>
                                                                                                                                     <a href="../../" title="Jakarta Cactus" class="poweredBy">
        <img class="poweredBy"  alt="Jakarta Cactus" src="../images/cactusbanner.gif"     />
      </a>
                     
            </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
        

    

        <div class="section">
<h2><a name="JSP_Testing_in_Cactus"></a>JSP Testing in Cactus</h2>

            
<p>
                This tutorial explains how Cactus can be used to test JSP.
            </p>
            
<p>
                There are different kibds of tests that you can implement with
                Cactus for testing JSP:
            </p>
            
<ul>
                
<li>
                    <a href="howto_jsp.html#jsp_type1">type 1</a>:
                    You may simply want to verify the result of the JSP processing,
                    i.e. the HTML, XML or other format it returns.
                </li>
                
<li>
                    <a href="howto_jsp.html#jsp_type2">type 2</a>:
                    You may want to unit test your JSP taglibs.
                </li>
                
<li>
                    <a href="howto_jsp.html#jsp_type2">type 3</a>:
                    You may want to test your JSP in isolation by being able to
                    execute it without the java logic being present. This is often
                    the case when the team is split into 2: one group for page
                    development and another group for the java logic.
                </li>
            </ul>

        </div>

        <a name="jsp_type1"></a>
<div class="section" id="jsp_type1">
<h2><a name="Type_1:_verifying_JSP_result"></a>Type 1: verifying JSP result</h2>

            
<p>
                This is easily done by implementing a
                <tt>endXXX(WebResponse)</tt>
                method as described in the
                <a href="howto_testcase.html#endxxx">TestCase tutorial</a>.
            </p>
            
<p>
                Your test case class will also need to extend
                <tt>ServletTestCase</tt>
                and forward the request to your JSP
                page, as in the following example:
            </p>

            
<div class="source">
<pre>
public class MyTest extends ServletTestCase
{
    [...]
    
    public void testXXX()
    {
        RequestDispatcher rd = theConfig.getServletContext().
            getRequestDispatcher(&quot;/path/to/test.jsp&quot;);
        rd.forward(theRequest, theResponse);
    }
    
    public void endXXX(WebResponse)
    {
        // Assert result
        [...]
    }
    
    [...]
}        
</pre></div>

        </div>

        <a name="jsp_type2"></a>
<div class="section" id="jsp_type2">
<h2><a name="Type_2:_testing_JSP_taglibs"></a>Type 2: testing JSP taglibs</h2>

            
<p>
                This is easily done by creating a test case class that extends
                <tt>JspTestCase</tt>. See the
                <a href="howto_testcase_jsp.html">Taglib TestCase
                    tutorial</a>.
            </p>

        </div>

        <a name="jsp_type3"></a>
<div class="section" id="jsp_type3">
<h2><a name="Type_3:_testing_JSP_in_isolation"></a>Type 3: testing JSP in isolation</h2>

            
<p>
                This type of testing depends mostly on your architecture. The general
                idea is that you would normally have an MVC implementation with a
                controller (usually a Servlet) that inspect the HTTP request,
                potentially gather some other data from the Session, ServletContext or
                some storage and based on this information decides to call some
                business code logic, and then forward the call to a given JSP page.
            </p>
            
<p>
                Thus, one solution to unit test your JSP in isolation is to succeed
                in either bypassing the controller altogether or in telling it to use
                some mock code logic that you would write for your tests.
            </p>

            
<div class="section">
<h3><a name="Example1"></a>Example1</h3>

                
<div class="source">
<pre>
public class MyTestCase extends JspTestCase
{
[...]

    public void beginXXX(WebRequest webRequest)
    {
        webRequest.addParameter(&quot;cacheId&quot;, &quot;1&quot;);
    }
	
    public void testXXX() throws Exception 
	{
        PageBean bean = new PageBean();
        bean.setName(&quot;kevin&quot;);
        request.setAttribute(&quot;pageBean&quot;, bean);
        pageContext.forward(&quot;/test.jsp&quot;);
	}
	
    public void endXXX(com.meterware.httpunit.WebResponse theResponse)
    {
        WebTable table = theResponse.getTables()[0];
        assertEquals(&quot;rows&quot;, 4, table.getRowCount());
        assertEquals(&quot;columns&quot;, 3, table.getColumnCount());
        assertEquals(&quot;links&quot;, 1, table.getTableCell(0, 2).getLinks().length);
       [...]
    }
}
</pre></div>

                
<p>
                    In <tt>testXXX()</tt>, we populate a bean with values for our
                    test and put this bean in the request. Normally this would have
                    been performed by the controller but we're bypassing it for the
                    test. Then we call our JSP page, which looks like:
                </p>

                
<div class="source">
<pre>
&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;
&lt;HTML&gt;
  &lt;HEAD&gt;
    &lt;TITLE&gt;test.jsp&lt;/TITLE&gt;
  &lt;/HEAD&gt;
  &lt;BODY&gt;
    &lt;P&gt;&lt;BR&gt;
      &lt;jsp:useBean id=&quot;pageBean&quot; class=&quot;PageBean&quot; scope=&quot;request&quot;/&gt;
    &lt;/P&gt;
    &lt;P&gt;
      &lt;%= pageBean.getName() %&gt;
    &lt;/P&gt;&lt;BR&gt;
    
    Place test.jsp's content here
  &lt;/BODY&gt;
&lt;/HTML&gt;
</pre></div>

            </div>

            
<div class="section">
<h3><a name="Example2:_Struts_application"></a>Example2: Struts application</h3>

                
<p>
                    See the
                    <a class="externalLink" href="http://strutstestcase.sourceforge.net/">StrutsTestCase</a>
                    project.
                </p>

            </div>

        </div>

    

      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">
              Copyright &#169;                    2001&#x2013;2017
                        <a href="http://www.apache.org/">The Apache Software Foundation</a>.
            All rights reserved.    
                  </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
